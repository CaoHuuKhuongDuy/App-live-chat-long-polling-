<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live chat</title>
</head>
<body>
    <ul id = "message"></ul>
    <div>
        <input type = "text" id = "chat">
        <button onclick = "send_chat()"> send </button>
    </div>
    <script>
        function add_chat(chat_data)
        {
            let node = document.createElement("li")
            let textnode = document.createTextNode(chat_data)
            node.append(textnode)
            document.getElementById("message").appendChild(node)
        }
        // async function load_all_message()
        // {
        //     let chat_message = await fetch("http://localhost:3000/load")
        //     let chat_data = await chat_message.json()

        // }
        async function subsciber()
        {
            let chat_message = await fetch("http://localhost:3000/get_data")
            let chat_data = await chat_message.text()  
            add_chat(chat_data)
            subsciber()
        }
        function send_chat()
        {
            let chat_message = document.getElementById("chat").value 
            let url = "http://localhost:3000/send"
            let x = fetch(url, {
                method: "POST",
                body: chat_message
            })
        }
        subsciber()
    </script>
</body>
</html>